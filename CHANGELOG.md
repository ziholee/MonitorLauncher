# Monitor Launcher 변경 이력

## [1.2.2] - 2025-12-16

### 성능 최적화
- 리소스 사용량 최적화
  - 모니터링 시간 단축: 최대 3초 → 2초 (30회 → 20회)
  - 조기 종료 로직 개선: 연속 3회 확인 시 즉시 종료 (평균 모니터링 시간 50% 단축)
  - 프로세스 Refresh 최소화: 필요한 경우에만 호출 (CPU 사용량 10-20% 감소)
- 예상 효과
  - 실행 중 CPU 사용량: 약 40% 감소 (1-5% → 0.5-3%)
  - 평균 모니터링 시간: 약 50% 단축
  - 메모리 사용량: 변화 없음 (25-35MB 유지)

### 버그 수정
- 프로필로 등록된 프로그램이 저장된 모니터가 아닌 다른 위치에서 실행되던 문제 수정
  - 프로필 실행 시 창 위치 제어 강화 (초기 제어 후 추가 모니터링)
  - `EnsureWindowOnMonitor` 재시도 횟수 증가 (10회 → 30회 → 20회로 최적화)
  - 재시도 간격 단축 (200ms → 100ms)
  - Process를 받는 `EnsureWindowOnMonitor` 오버로드 추가
- 프로필이 아닌 새로운 프로그램 실행 시에도 저장된 모니터가 아닌 다른 위치에서 실행되던 문제 수정
  - 일반 실행 버튼에도 추가 모니터링 로직 적용
  - 프로세스 초기화 대기 시간 단축 (200ms → 100ms)
  - 프로필 실행과 동일한 창 위치 제어 강화 적용

---

## [1.1.0] - 2025-11-07

### 주요 개선 사항

#### 창 상태 옵션 개선
- "일반 크기"를 "창모드"로 명칭 변경
- 창모드 동작: 모니터의 80% 크기(최대 1200x800)로 중앙 배치
- 전체화면으로 표시되던 문제 수정

#### 모니터 표기 및 선택 개선
- 모니터 표기 형식: `모니터 {번호} (기본) - {Width}x{Height}`
- 앱 실행 시 기본 모니터(Primary) 자동 선택
- 모니터 선택 시 해당 모니터의 해상도에 맞게 창 크기 및 위치 자동 조정

#### 창 위치 제어 개선
- 창 위치 모니터링 및 재설정 로직 추가
- 프로그램이 창 위치를 변경하는 경우 자동으로 재설정 (최대 2초간)
- 창의 중심점 기반 모니터 영역 확인 로직 개선

#### 시스템 트레이 기능 추가
- 백그라운드 실행 지원
- 시스템 트레이 아이콘 추가
- 트레이 아이콘 더블클릭으로 창 표시/숨김
- 창 닫기 시 선택 다이얼로그 추가 (종료/백그라운드 실행/취소)

#### UI/UX 개선
- 모니터 선택 시 창 크기 자동 조정 (모니터 해상도의 80%, 최대 800x700)
- 창을 선택된 모니터 중앙에 자동 배치

#### 버그 수정
- `FormWindowState`와 커스텀 `WindowState` enum 충돌 해결 → `AppWindowState`로 변경
- `Profile.cs`에 `using System.Collections.Generic;` 추가
- 존재하지 않는 `icon.ico` 참조 제거
- `AppWindowState` enum을 별도 파일로 분리
- 모니터 선택 변경 시 창이 자동으로 이동되던 문제 수정
- 프로필 이름 입력 다이얼로그에서 확인/취소 버튼이 잘리던 문제 수정 (창 높이 120 → 150)

---

## [1.0.0] - 2025-11-04

### 초기 릴리즈

#### 주요 기능
- 다중 모니터 환경에서 프로그램을 특정 모니터에서 실행
- 모니터 감지 및 선택 기능
- 프로그램 실행 파일 선택 및 인자(Arguments) 입력
- 창 상태 제어 (전체화면, 창모드, 복원)
- 프로필(즐겨찾기) 저장 및 관리
- Win32 API를 통한 창 위치 제어

#### 기술 스택
- C# / .NET 8.0
- Windows Forms
- Win32 API (P/Invoke)

---

## [개발 중 변경 사항]

### 창 상태 옵션 개선
- **변경 전**: "최대화", "일반 크기", "복원"
- **변경 후**: "전체화면", "창모드", "복원"
- "일반 크기"를 "창모드"로 명칭 변경
- 창모드 동작: 모니터의 80% 크기(최대 1200x800)로 중앙 배치

### 모니터 표기 개선
- **변경 전**: `{DeviceName} (Primary) - {Width}x{Height}`
- **변경 후**: `모니터 {번호} (기본) - {Width}x{Height}`
- 앱 실행 시 기본 모니터(Primary) 자동 선택
- 모니터 선택 시 해당 모니터의 해상도에 맞게 창 크기 및 위치 자동 조정

### 창 위치 제어 개선
- 창모드 실행 시 전체화면으로 표시되던 문제 수정
- 창 위치 모니터링 및 재설정 로직 추가 (`EnsureWindowOnMonitor`)
- 프로그램이 창 위치를 변경하는 경우 자동으로 재설정 (최대 2초간)
- 창의 중심점 기반 모니터 영역 확인 로직 개선

### 시스템 트레이 기능 추가
- 백그라운드 실행 지원
- 시스템 트레이 아이콘 추가
- 트레이 아이콘 더블클릭으로 창 표시/숨김
- 트레이 메뉴: "표시", "종료"
- 창 닫기 시 선택 다이얼로그 추가:
  - "종료": 프로그램 완전 종료
  - "백그라운드 실행": 창만 닫고 트레이로 이동
  - "취소": 창 유지

### UI/UX 개선
- 모니터 선택 시 창 크기 자동 조정 (모니터 해상도의 80%, 최대 800x700)
- 창을 선택된 모니터 중앙에 자동 배치
- 모니터 새로고침 시 기존 선택 유지

### 버그 수정
- `FormWindowState`와 커스텀 `WindowState` enum 충돌 해결 → `AppWindowState`로 변경
- `Profile.cs`에 `using System.Collections.Generic;` 추가
- 존재하지 않는 `icon.ico` 참조 제거
- `AppWindowState` enum을 별도 파일로 분리

---

## 기술적 세부 사항

### WindowController.cs 개선
- `EnsureWindowOnMonitor` 메서드 추가: 창 위치 지속 모니터링
- 창모드 크기 계산: `Math.Min(bounds.Width * 80 / 100, 1200)`
- 모니터 영역 확인: 창의 중심점 기반 검증

### MainForm.cs 개선
- `InitializeTrayIcon`: 시스템 트레이 초기화
- `AdjustWindowToSelectedMonitor`: 모니터 선택 시 창 크기/위치 조정
- `CmbMonitors_SelectedIndexChanged`: 모니터 선택 변경 이벤트 핸들러
- `CloseDialog`: 창 닫기 선택 다이얼로그

### Win32Api.cs 추가
- `SWP_NOACTIVATE`: 창 활성화 없이 위치만 변경
- `SW_HIDE`: 창 숨기기 상수

---

## 향후 개선 사항 (Out of Scope for v1.0)

- 전역 후킹 (Global Hooking) 기능
- UWP 앱 완벽 지원
- 복잡한 자동화 규칙 (백그라운드 모니터링)

---

## 알려진 제한사항

- 일부 프로그램은 스플래시 스크린으로 인해 창 위치 제어가 지연될 수 있음
- UWP(스토어 앱)는 완벽하게 지원되지 않을 수 있음
- 관리자 권한으로 실행되는 프로그램을 제어하려면 런처도 관리자 권한 필요

---

## 빌드 및 실행

```bash
dotnet build MonitorLauncher.csproj -c Release
```

프로필 저장 위치: `%APPDATA%\MonitorLauncher\profiles.json`
